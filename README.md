# Практическая работа №4

## Тема: Cubit

## Цель работы: реализовать кликер если светлая тема за клик прибавляет +1 если темная тема прибавляется +2 а так же нужно отнимать -1 если светлая и -2 за темную. Реализовать список нажатий и при какой теме это было реализовано. Все должно находиться на одном экране. Сохранять все данные в SharedPreferences (тему, счетчик, историю действий). Реализовать удаление данных из SharedPreferences. Если пользователь не нажимает на кнопку в течение 5 секунд счетчик должен сам прибавляться.

## Ход работы: 

1.	Добавим необходимые зависимости для работы с Cubit и SharedPreferences:

![Изображение с Imgur. Пункт 1](https://i.imgur.com/g4GiiiL.png)

2.	Также установим расширение в Visual Studio Code для работы с зависимостью Bloc:

![Изображение с Imgur. Пункт 2](https://i.imgur.com/gdm1tat.png)

3.	В созданном проекте создадим в папке lib cubit и назовём его ChangeThemCounter:

![Изображение с Imgur. Пункт 3](https://i.imgur.com/LPQWlVc.png)

4.	В созданном файле change_them_counter_state пропишем следующей код, который при изменении темы будет записывать новую тему, а при добавлении/убавлении значения будет принимать в себя текущее значение счётчика и тему:

![Изображение с Imgur. Пункт 4](https://i.imgur.com/I5xm2AP.png)

5.	А в файле change_them_counter_cubit пропишем следующий код, который будет принимать в себя тему и в зависимости от темы прибавлять/убавлять 1 или 2:

![Изображение с Imgur. Пункт 5](https://i.imgur.com/ThvnnTd.png)

6.	Перейдём к файлу main.dart и пропишем во время build, чтобы возвращался BlockBuilder:

![Изображение с Imgur. Пункт 6](https://i.imgur.com/1psyKf4.png)

7.	Затем создадим класс body StatefulWidget:

![Изображение с Imgur. Пункт 7](https://i.imgur.com/A42rs1v.png)

8.	И затем уже создадим _BodyState, в котором сначала проверим, есть ли значения в SharedPreferences и если есть, то мы выведем прошлые значение счётчика (историю) и применим нужную тему. Также произведём инициализацию счётчика, который каждые 5 секунд будет прибавлять значение в случае бездействия пользователя:

![Изображение с Imgur. Пункт 8](https://i.imgur.com/0wfMPry.png)

Затем в данном классе пропишем уже вёрстку

![Изображение с Imgur. Пункт 8.1](https://i.imgur.com/kPXyGpQ.png)

9.	В результате получилось следующее. При изменении темы значение прибавления/убавления меняется на 1 или 2. В случае, если не нажимаются кнопки «Прибавить значение» и «Убавить значение», то по истечению 5 секунд значение в зависимости от темы прибавляется автоматически. В случае, если закрыть приложение и открыть снова, то история действий выведется та, которая была на момент закрытия и тема также применится, которая была выбрана до момент закрытия приложения. При необходимости историю из SharedPreferences можно очистить

Слева показано добавление/изменение счётчика, изменение темы. Справа – история очищена и нажатие на кнопки «Добавить»/«Убавить» не осуществлялось и таймер добавляет значения автоматически:

![Изображение с Imgur. Пункт 9](https://i.imgur.com/RBaPm21.png)

## Вывод: в рамках данной практической работы были получены навыки в работе с Cubit в языке программирования Dart. Реализован кликер: если светлая тема за клик прибавляет +1 если темная тема прибавляется +2, а так при нажатии кнопки «Отнять» -1 если светлая и -2 за темную. Реализован список нажатий и при какой теме это было реализовано. Все данные хранятся в SharedPreferences. Реализована очистка данных из SharedPreferences. Реализован Timer, который в случае, если пользователь не нажимает на кнопку «+» или «-», то значение по истечению 5 минут добавляется автоматически в зависимости от темы.
